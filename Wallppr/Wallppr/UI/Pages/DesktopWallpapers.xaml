<local:BasePage x:TypeArguments="viewmodel:DesktopWallpapersViewModel" x:Class="Wallppr.UI.Pages.DesktopWallpapers"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Wallppr.UI.Pages"
      xmlns:viewmodel="clr-namespace:Wallppr.ViewModel.Wallpaper"
      xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
      mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <ComboBox Height="45" Width="475"
                  Margin="0 0 0 10"
                  ItemsSource="{Binding ResolutionRatios}"
                  SelectedItem="{Binding SelectedResolutionRatio}"
                  ItemTemplate="{StaticResource ResolutionRatioDataTemplate}"/>

        <!-- List Items -->
        <ListView x:Name="Wallpapers" Grid.Row="1"
                  Margin="0 10 0 0"
                  ItemTemplate="{StaticResource WallpaperItemDataTemplate}" 
                  ItemsSource="{Binding Wallpapers}"
                  VerticalAlignment="Top"
                  ScrollViewer.CanContentScroll="False"/>

        <!-- Pagination -->
        <Grid Grid.Row="2" Margin="0 5 0 0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Page Navigation -->
            <ListView ItemsSource="{Binding Pagination.Pages}"
                      ItemTemplate="{StaticResource PaginationItemDataTemplate}"
                      Visibility="{Binding ElementName=Wallpapers, Path=HasItems,
                                   Converter={StaticResource BoolToVisibilityConverter}}"/>

            <!-- Result Counts -->
            <TextBlock Grid.Column="1"
                       Foreground="{StaticResource Teal700Brush}"
                       VerticalAlignment="Center"
                       Margin="20 0">
                <TextBlock.Text>
                    <MultiBinding StringFormat="{}{1} of {0}">
                        <Binding Path="Pagination.TotalItems"/>
                        <Binding ElementName="Wallpapers" Path="Items.Count"/>
                    </MultiBinding>
                </TextBlock.Text>
            </TextBlock>
        </Grid>

        <Grid Grid.RowSpan="4" 
              Visibility="{Binding ProgressVisibility, FallbackValue=Hidden}">
            <Border Background="{StaticResource ThemeColor1Brush}"
                    Opacity=".8">
            </Border>

            <StackPanel Orientation="Vertical"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Center">
                <ProgressBar Value="{Binding DownloadProgress}" 
                             Margin="0 20"
                             Maximum="100"
                             Height="30" Width="200"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center">
                    <ProgressBar.Foreground>
                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="1,1">
                            <GradientStop Color="{Binding SelectedWallpaper.ColorPalette[0].ColorCode}" Offset="0.2" />
                            <GradientStop Color="{Binding SelectedWallpaper.ColorPalette[1].ColorCode}" Offset="0.4" />
                            <GradientStop Color="{Binding SelectedWallpaper.ColorPalette[2].ColorCode}" Offset="0.5" />
                            <GradientStop Color="{Binding SelectedWallpaper.ColorPalette[3].ColorCode}" Offset="0.6" />
                            <GradientStop Color="{Binding SelectedWallpaper.ColorPalette[4].ColorCode}" Offset="0.8" />
                        </LinearGradientBrush>
                    </ProgressBar.Foreground>
                </ProgressBar>
                <TextBlock Text="DOWNLOADING..."
                           Foreground="{StaticResource ThemeColor4Brush}"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Center"/>
            </StackPanel>
        </Grid>
    </Grid>

</local:BasePage>